
# ===========================================
# CONFIGURAÇÃO DE AUTENTICAÇÃO SSL OBRIGATÓRIA
# ===========================================

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Conexões SSL obrigatórias para usuários da aplicação
hostssl    whatsapp_agent    whatsapp_app         0.0.0.0/0                 scram-sha-256
hostssl    whatsapp_agent    whatsapp_backup      0.0.0.0/0                 scram-sha-256
hostssl    whatsapp_agent    whatsapp_readonly    0.0.0.0/0                 scram-sha-256

# Administrador apenas com SSL
hostssl    whatsapp_agent    vancimj              0.0.0.0/0                 scram-sha-256

# Conexões locais (apenas para manutenção)
local      all               postgres                                       peer
local      all               all                                            peer

# Negar todas as conexões não-SSL
host       all               all                  0.0.0.0/0                 reject

# IPv6 (se habilitado)
hostssl    all               all                  ::1/128                   scram-sha-256
