
        <!DOCTYPE html>
        <html lang="pt-BR">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>WhatsApp Agent - Relatório de Testes</title>
            <style>
                body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
                .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
                .header { text-align: center; margin-bottom: 40px; }
                .header h1 { color: #2c3e50; margin-bottom: 10px; }
                .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }
                .stat-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; text-align: center; }
                .stat-card h3 { margin: 0 0 10px 0; font-size: 2em; }
                .stat-card p { margin: 0; opacity: 0.9; }
                .test-results { margin-bottom: 40px; }
                .test-item { background: #f8f9fa; margin: 10px 0; padding: 20px; border-radius: 8px; border-left: 4px solid #ddd; }
                .test-passed { border-left-color: #28a745; }
                .test-failed { border-left-color: #dc3545; }
                .test-warning { border-left-color: #ffc107; }
                .test-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
                .test-name { font-weight: bold; font-size: 1.1em; }
                .test-duration { color: #6c757d; font-size: 0.9em; }
                .test-details { color: #495057; white-space: pre-line; }
                .test-error { background: #f8d7da; color: #721c24; padding: 10px; border-radius: 4px; margin-top: 10px; }
                .metrics { background: #e9ecef; padding: 15px; border-radius: 4px; margin-top: 10px; }
                .footer { text-align: center; color: #6c757d; font-size: 0.9em; }
            </style>
        </head>
        <body>
            <div class="container">
                <div class="header">
                    <h1>🧪 WhatsApp Agent - Relatório de Testes</h1>
                    <p>Executado em: 09/08/2025 às 20:33:08</p>
                    <p>Duração total: 347.93 segundos</p>
                </div>
                
                <div class="stats">
                    <div class="stat-card">
                        <h3>9</h3>
                        <p>Total de Testes</p>
                    </div>
                    <div class="stat-card">
                        <h3>7</h3>
                        <p>Testes Passou</p>
                    </div>
                    <div class="stat-card">
                        <h3>1</h3>
                        <p>Testes Falharam</p>
                    </div>
                    <div class="stat-card">
                        <h3>77.8%</h3>
                        <p>Taxa de Sucesso</p>
                    </div>
                </div>
                
                <div class="test-results">
                    <h2>📊 Resultados Detalhados</h2>
        
                    <div class="test-item test-passed">
                        <div class="test-header">
                            <span class="test-name">✅ Database Schema Analysis</span>
                            <span class="test-duration">0.15s</span>
                        </div>
                        <div class="test-details">
                📊 Schema Analysis Complete:
                - 21 tabelas encontradas
                - 78 índices
                - 42 constraints
                - 2009 registros totais
                - Schema salvo em: test_reports/database_schema.json
                </div>
            <div class="metrics"><strong>Métricas:</strong><pre>tables: [{'name': 'admin_users', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('admin_users_id_seq'::regclass)"}, {'column_name': 'username', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'email', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'password_hash', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'full_name', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'is_active', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'is_super_admin', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'last_login', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 2}, {'name': 'admins', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('admins_id_seq'::regclass)"}, {'column_name': 'username', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'email', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'hashed_password', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'is_active', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 0}, {'name': 'alembic_version', 'type': 'BASE TABLE', 'columns': [{'column_name': 'version_num', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}], 'record_count': 1}, {'name': 'appointments', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('appointments_id_seq'::regclass)"}, {'column_name': 'user_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'date_time', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'status', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'notes', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'service_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'end_time', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'customer_notes', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'admin_notes', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'cancelled_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'cancellation_reason', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'cancelled_by', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'confirmed_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'confirmed_by', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'price_at_booking', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 1}, {'name': 'available_slots', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('available_slots_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'service_id', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'duration_minutes', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'is_available', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'is_blocked', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'blocked_reason', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'day_of_week', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'slot_time', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'date', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'start_time', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'end_time', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'max_appointments', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'current_appointments', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 0}, {'name': 'blocked_times', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('blocked_times_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'start_time', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'end_time', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'reason', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'block_type', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'is_recurring', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'recurrence_pattern', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'created_by', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'start_date', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'end_date', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}], 'record_count': 1}, {'name': 'bot_configurations', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('bot_configurations_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'min_advance_booking_hours', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'max_advance_booking_days', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'auto_confirm_bookings', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'slot_duration_minutes', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'break_between_appointments_minutes', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'send_confirmation_messages', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'send_reminder_messages', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'reminder_hours_before', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'max_retries_data_collection', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'timeout_minutes_user_response', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'enable_human_handoff', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'auto_response_enabled', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'response_delay_min', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'response_delay_max', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'max_retries', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'language', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'timezone', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'max_message_length', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'working_hours_only', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'weekend_support', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'appointment_enabled', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'max_appointments_per_day', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'appointment_buffer_minutes', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'notification_lead_time_hours', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'follow_up_enabled', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'follow_up_delay_minutes', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'data_collection_enabled', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'required_fields', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'optional_fields', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 1}, {'name': 'business_hours', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('business_hours_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'day_of_week', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'is_open', 'data_type': 'boolean', 'is_nullable': 'NO', 'column_default': 'true'}, {'column_name': 'open_time', 'data_type': 'time without time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'close_time', 'data_type': 'time without time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'break_start_time', 'data_type': 'time without time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'break_end_time', 'data_type': 'time without time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'notes', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}], 'record_count': 7}, {'name': 'business_policies', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('business_policies_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'policy_type', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'title', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'description', 'data_type': 'text', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'rules', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'is_active', 'data_type': 'boolean', 'is_nullable': 'NO', 'column_default': 'true'}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}], 'record_count': 3}, {'name': 'businesses', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('businesses_id_seq'::regclass)"}, {'column_name': 'name', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'phone', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'email', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'address', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'description', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'business_hours', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 2}, {'name': 'company_info', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('company_info_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'company_name', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'slogan', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'about_us', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'whatsapp_number', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'phone_secondary', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'email_contact', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'website', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'street_address', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'city', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'state', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'zip_code', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'country', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'instagram', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'facebook', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'linkedin', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'welcome_message', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'auto_response_enabled', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'business_description', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 1}, {'name': 'conversation_contexts', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('conversation_contexts_id_seq'::regclass)"}, {'column_name': 'conversation_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'current_state', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'previous_state', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'temp_data', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'collected_data', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'booking_data', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'retry_count', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'max_retries', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'awaiting_response', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'awaiting_response_for', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'state_changed_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'last_interaction_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 1}, {'name': 'conversations', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('conversations_id_seq'::regclass)"}, {'column_name': 'user_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'status', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'last_message_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 52}, {'name': 'customer_data_collection', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('customer_data_collection_id_seq'::regclass)"}, {'column_name': 'user_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'collection_status', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'has_name', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'has_email', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'has_phone', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'name_attempts', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'email_attempts', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'phone_attempts', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'collection_method', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'notes', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'last_attempt_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'completed_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 1}, {'name': 'login_sessions', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('login_sessions_id_seq'::regclass)"}, {'column_name': 'session_token', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'admin_user_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'ip_address', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'user_agent', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'expires_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'is_active', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 3}, {'name': 'message_templates', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('message_templates_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'template_key', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'template_name', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'template_content', 'data_type': 'text', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'available_variables', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'is_active', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'category', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 5}, {'name': 'messages', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('messages_id_seq'::regclass)"}, {'column_name': 'user_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'conversation_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'direction', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'message_id', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'content', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'message_type', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'raw_payload', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}], 'record_count': 704}, {'name': 'meta_logs', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('meta_logs_id_seq'::regclass)"}, {'column_name': 'direction', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'endpoint', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'method', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'status_code', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'headers', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'payload', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'response', 'data_type': 'json', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}], 'record_count': 1159}, {'name': 'payment_methods', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('payment_methods_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'name', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'is_active', 'data_type': 'boolean', 'is_nullable': 'NO', 'column_default': 'true'}, {'column_name': 'description', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'additional_info', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'display_order', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': '0'}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}], 'record_count': 4}, {'name': 'services', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('services_id_seq'::regclass)"}, {'column_name': 'business_id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'name', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'description', 'data_type': 'text', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'duration_minutes', 'data_type': 'integer', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'price', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'is_active', 'data_type': 'boolean', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 4}, {'name': 'users', 'type': 'BASE TABLE', 'columns': [{'column_name': 'id', 'data_type': 'integer', 'is_nullable': 'NO', 'column_default': "nextval('users_id_seq'::regclass)"}, {'column_name': 'wa_id', 'data_type': 'character varying', 'is_nullable': 'NO', 'column_default': None}, {'column_name': 'nome', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'telefone', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'email', 'data_type': 'character varying', 'is_nullable': 'YES', 'column_default': None}, {'column_name': 'created_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': 'now()'}, {'column_name': 'updated_at', 'data_type': 'timestamp with time zone', 'is_nullable': 'YES', 'column_default': None}], 'record_count': 57}]
indexes: [{'schemaname': 'public', 'tablename': 'alembic_version', 'indexname': 'alembic_version_pkc', 'indexdef': 'CREATE UNIQUE INDEX alembic_version_pkc ON public.alembic_version USING btree (version_num)'}, {'schemaname': 'public', 'tablename': 'admins', 'indexname': 'admins_pkey', 'indexdef': 'CREATE UNIQUE INDEX admins_pkey ON public.admins USING btree (id)'}, {'schemaname': 'public', 'tablename': 'admins', 'indexname': 'admins_email_key', 'indexdef': 'CREATE UNIQUE INDEX admins_email_key ON public.admins USING btree (email)'}, {'schemaname': 'public', 'tablename': 'admins', 'indexname': 'admins_username_key', 'indexdef': 'CREATE UNIQUE INDEX admins_username_key ON public.admins USING btree (username)'}, {'schemaname': 'public', 'tablename': 'admins', 'indexname': 'ix_admins_id', 'indexdef': 'CREATE INDEX ix_admins_id ON public.admins USING btree (id)'}, {'schemaname': 'public', 'tablename': 'users', 'indexname': 'users_pkey', 'indexdef': 'CREATE UNIQUE INDEX users_pkey ON public.users USING btree (id)'}, {'schemaname': 'public', 'tablename': 'users', 'indexname': 'ix_users_id', 'indexdef': 'CREATE INDEX ix_users_id ON public.users USING btree (id)'}, {'schemaname': 'public', 'tablename': 'meta_logs', 'indexname': 'meta_logs_pkey', 'indexdef': 'CREATE UNIQUE INDEX meta_logs_pkey ON public.meta_logs USING btree (id)'}, {'schemaname': 'public', 'tablename': 'meta_logs', 'indexname': 'ix_meta_logs_id', 'indexdef': 'CREATE INDEX ix_meta_logs_id ON public.meta_logs USING btree (id)'}, {'schemaname': 'public', 'tablename': 'appointments', 'indexname': 'appointments_pkey', 'indexdef': 'CREATE UNIQUE INDEX appointments_pkey ON public.appointments USING btree (id)'}, {'schemaname': 'public', 'tablename': 'appointments', 'indexname': 'ix_appointments_id', 'indexdef': 'CREATE INDEX ix_appointments_id ON public.appointments USING btree (id)'}, {'schemaname': 'public', 'tablename': 'conversations', 'indexname': 'conversations_pkey', 'indexdef': 'CREATE UNIQUE INDEX conversations_pkey ON public.conversations USING btree (id)'}, {'schemaname': 'public', 'tablename': 'conversations', 'indexname': 'ix_conversations_id', 'indexdef': 'CREATE INDEX ix_conversations_id ON public.conversations USING btree (id)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'messages_pkey', 'indexdef': 'CREATE UNIQUE INDEX messages_pkey ON public.messages USING btree (id)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'ix_messages_id', 'indexdef': 'CREATE INDEX ix_messages_id ON public.messages USING btree (id)'}, {'schemaname': 'public', 'tablename': 'businesses', 'indexname': 'businesses_pkey', 'indexdef': 'CREATE UNIQUE INDEX businesses_pkey ON public.businesses USING btree (id)'}, {'schemaname': 'public', 'tablename': 'businesses', 'indexname': 'ix_businesses_id', 'indexdef': 'CREATE INDEX ix_businesses_id ON public.businesses USING btree (id)'}, {'schemaname': 'public', 'tablename': 'blocked_times', 'indexname': 'blocked_times_pkey', 'indexdef': 'CREATE UNIQUE INDEX blocked_times_pkey ON public.blocked_times USING btree (id)'}, {'schemaname': 'public', 'tablename': 'blocked_times', 'indexname': 'ix_blocked_times_id', 'indexdef': 'CREATE INDEX ix_blocked_times_id ON public.blocked_times USING btree (id)'}, {'schemaname': 'public', 'tablename': 'services', 'indexname': 'services_pkey', 'indexdef': 'CREATE UNIQUE INDEX services_pkey ON public.services USING btree (id)'}, {'schemaname': 'public', 'tablename': 'services', 'indexname': 'ix_services_id', 'indexdef': 'CREATE INDEX ix_services_id ON public.services USING btree (id)'}, {'schemaname': 'public', 'tablename': 'users', 'indexname': 'ix_users_wa_id', 'indexdef': 'CREATE UNIQUE INDEX ix_users_wa_id ON public.users USING btree (wa_id)'}, {'schemaname': 'public', 'tablename': 'company_info', 'indexname': 'company_info_pkey', 'indexdef': 'CREATE UNIQUE INDEX company_info_pkey ON public.company_info USING btree (id)'}, {'schemaname': 'public', 'tablename': 'company_info', 'indexname': 'ix_company_info_id', 'indexdef': 'CREATE INDEX ix_company_info_id ON public.company_info USING btree (id)'}, {'schemaname': 'public', 'tablename': 'message_templates', 'indexname': 'message_templates_pkey', 'indexdef': 'CREATE UNIQUE INDEX message_templates_pkey ON public.message_templates USING btree (id)'}, {'schemaname': 'public', 'tablename': 'message_templates', 'indexname': 'ix_message_templates_id', 'indexdef': 'CREATE INDEX ix_message_templates_id ON public.message_templates USING btree (id)'}, {'schemaname': 'public', 'tablename': 'bot_configurations', 'indexname': 'bot_configurations_pkey', 'indexdef': 'CREATE UNIQUE INDEX bot_configurations_pkey ON public.bot_configurations USING btree (id)'}, {'schemaname': 'public', 'tablename': 'bot_configurations', 'indexname': 'ix_bot_configurations_id', 'indexdef': 'CREATE INDEX ix_bot_configurations_id ON public.bot_configurations USING btree (id)'}, {'schemaname': 'public', 'tablename': 'available_slots', 'indexname': 'available_slots_pkey', 'indexdef': 'CREATE UNIQUE INDEX available_slots_pkey ON public.available_slots USING btree (id)'}, {'schemaname': 'public', 'tablename': 'available_slots', 'indexname': 'ix_available_slots_id', 'indexdef': 'CREATE INDEX ix_available_slots_id ON public.available_slots USING btree (id)'}, {'schemaname': 'public', 'tablename': 'customer_data_collection', 'indexname': 'customer_data_collection_pkey', 'indexdef': 'CREATE UNIQUE INDEX customer_data_collection_pkey ON public.customer_data_collection USING btree (id)'}, {'schemaname': 'public', 'tablename': 'customer_data_collection', 'indexname': 'ix_customer_data_collection_id', 'indexdef': 'CREATE INDEX ix_customer_data_collection_id ON public.customer_data_collection USING btree (id)'}, {'schemaname': 'public', 'tablename': 'conversation_contexts', 'indexname': 'conversation_contexts_pkey', 'indexdef': 'CREATE UNIQUE INDEX conversation_contexts_pkey ON public.conversation_contexts USING btree (id)'}, {'schemaname': 'public', 'tablename': 'conversation_contexts', 'indexname': 'ix_conversation_contexts_id', 'indexdef': 'CREATE INDEX ix_conversation_contexts_id ON public.conversation_contexts USING btree (id)'}, {'schemaname': 'public', 'tablename': 'business_hours', 'indexname': 'business_hours_pkey', 'indexdef': 'CREATE UNIQUE INDEX business_hours_pkey ON public.business_hours USING btree (id)'}, {'schemaname': 'public', 'tablename': 'payment_methods', 'indexname': 'payment_methods_pkey', 'indexdef': 'CREATE UNIQUE INDEX payment_methods_pkey ON public.payment_methods USING btree (id)'}, {'schemaname': 'public', 'tablename': 'business_policies', 'indexname': 'business_policies_pkey', 'indexdef': 'CREATE UNIQUE INDEX business_policies_pkey ON public.business_policies USING btree (id)'}, {'schemaname': 'public', 'tablename': 'business_hours', 'indexname': 'idx_business_hours_business_day', 'indexdef': 'CREATE INDEX idx_business_hours_business_day ON public.business_hours USING btree (business_id, day_of_week)'}, {'schemaname': 'public', 'tablename': 'payment_methods', 'indexname': 'idx_payment_methods_business', 'indexdef': 'CREATE INDEX idx_payment_methods_business ON public.payment_methods USING btree (business_id, is_active)'}, {'schemaname': 'public', 'tablename': 'business_policies', 'indexname': 'idx_business_policies_business_type', 'indexdef': 'CREATE INDEX idx_business_policies_business_type ON public.business_policies USING btree (business_id, policy_type, is_active)'}, {'schemaname': 'public', 'tablename': 'conversations', 'indexname': 'ix_conversations_status', 'indexdef': 'CREATE INDEX ix_conversations_status ON public.conversations USING btree (status)'}, {'schemaname': 'public', 'tablename': 'conversations', 'indexname': 'ix_conversations_last_message_at', 'indexdef': 'CREATE INDEX ix_conversations_last_message_at ON public.conversations USING btree (last_message_at)'}, {'schemaname': 'public', 'tablename': 'appointments', 'indexname': 'ix_appointments_date_time', 'indexdef': 'CREATE INDEX ix_appointments_date_time ON public.appointments USING btree (date_time)'}, {'schemaname': 'public', 'tablename': 'appointments', 'indexname': 'ix_appointments_status', 'indexdef': 'CREATE INDEX ix_appointments_status ON public.appointments USING btree (status)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'ix_messages_direction', 'indexdef': 'CREATE INDEX ix_messages_direction ON public.messages USING btree (direction)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'ix_messages_message_id', 'indexdef': 'CREATE INDEX ix_messages_message_id ON public.messages USING btree (message_id)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'ix_messages_message_type', 'indexdef': 'CREATE INDEX ix_messages_message_type ON public.messages USING btree (message_type)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'ix_messages_created_at', 'indexdef': 'CREATE INDEX ix_messages_created_at ON public.messages USING btree (created_at)'}, {'schemaname': 'public', 'tablename': 'admin_users', 'indexname': 'admin_users_pkey', 'indexdef': 'CREATE UNIQUE INDEX admin_users_pkey ON public.admin_users USING btree (id)'}, {'schemaname': 'public', 'tablename': 'admin_users', 'indexname': 'ix_admin_users_email', 'indexdef': 'CREATE UNIQUE INDEX ix_admin_users_email ON public.admin_users USING btree (email)'}, {'schemaname': 'public', 'tablename': 'admin_users', 'indexname': 'ix_admin_users_id', 'indexdef': 'CREATE INDEX ix_admin_users_id ON public.admin_users USING btree (id)'}, {'schemaname': 'public', 'tablename': 'admin_users', 'indexname': 'ix_admin_users_username', 'indexdef': 'CREATE UNIQUE INDEX ix_admin_users_username ON public.admin_users USING btree (username)'}, {'schemaname': 'public', 'tablename': 'login_sessions', 'indexname': 'login_sessions_pkey', 'indexdef': 'CREATE UNIQUE INDEX login_sessions_pkey ON public.login_sessions USING btree (id)'}, {'schemaname': 'public', 'tablename': 'login_sessions', 'indexname': 'ix_login_sessions_id', 'indexdef': 'CREATE INDEX ix_login_sessions_id ON public.login_sessions USING btree (id)'}, {'schemaname': 'public', 'tablename': 'login_sessions', 'indexname': 'ix_login_sessions_session_token', 'indexdef': 'CREATE UNIQUE INDEX ix_login_sessions_session_token ON public.login_sessions USING btree (session_token)'}, {'schemaname': 'public', 'tablename': 'admin_users', 'indexname': 'idx_test_optimization', 'indexdef': 'CREATE INDEX idx_test_optimization ON public.admin_users USING btree (created_at DESC)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'idx_messages_created_at', 'indexdef': 'CREATE INDEX idx_messages_created_at ON public.messages USING btree (created_at DESC)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'idx_messages_user_conversation', 'indexdef': 'CREATE INDEX idx_messages_user_conversation ON public.messages USING btree (user_id, conversation_id)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'idx_messages_content_search', 'indexdef': "CREATE INDEX idx_messages_content_search ON public.messages USING gin (to_tsvector('portuguese'::regconfig, content))"}, {'schemaname': 'public', 'tablename': 'conversations', 'indexname': 'idx_conversations_status_updated', 'indexdef': 'CREATE INDEX idx_conversations_status_updated ON public.conversations USING btree (status, updated_at DESC)'}, {'schemaname': 'public', 'tablename': 'conversations', 'indexname': 'idx_conversations_user_status', 'indexdef': 'CREATE INDEX idx_conversations_user_status ON public.conversations USING btree (user_id, status)'}, {'schemaname': 'public', 'tablename': 'conversations', 'indexname': 'idx_conversations_last_message', 'indexdef': 'CREATE INDEX idx_conversations_last_message ON public.conversations USING btree (last_message_at DESC)'}, {'schemaname': 'public', 'tablename': 'appointments', 'indexname': 'idx_appointments_status_created', 'indexdef': 'CREATE INDEX idx_appointments_status_created ON public.appointments USING btree (status, created_at DESC)'}, {'schemaname': 'public', 'tablename': 'meta_logs', 'indexname': 'idx_meta_logs_created_direction', 'indexdef': 'CREATE INDEX idx_meta_logs_created_direction ON public.meta_logs USING btree (created_at DESC, direction)'}, {'schemaname': 'public', 'tablename': 'meta_logs', 'indexname': 'idx_meta_logs_endpoint_status', 'indexdef': 'CREATE INDEX idx_meta_logs_endpoint_status ON public.meta_logs USING btree (endpoint, status_code)'}, {'schemaname': 'public', 'tablename': 'meta_logs', 'indexname': 'idx_meta_logs_error_analysis', 'indexdef': 'CREATE INDEX idx_meta_logs_error_analysis ON public.meta_logs USING btree (status_code) WHERE (status_code >= 400)'}, {'schemaname': 'public', 'tablename': 'admin_users', 'indexname': 'idx_admin_users_username_active', 'indexdef': 'CREATE INDEX idx_admin_users_username_active ON public.admin_users USING btree (username) WHERE (is_active = true)'}, {'schemaname': 'public', 'tablename': 'messages', 'indexname': 'idx_messages_direction', 'indexdef': 'CREATE INDEX idx_messages_direction ON public.messages USING btree (direction)'}, {'schemaname': 'public', 'tablename': 'conversations', 'indexname': 'idx_conversations_user_created', 'indexdef': 'CREATE INDEX idx_conversations_user_created ON public.conversations USING btree (user_id, created_at DESC)'}, {'schemaname': 'public', 'tablename': 'users', 'indexname': 'idx_users_wa_id', 'indexdef': 'CREATE INDEX idx_users_wa_id ON public.users USING btree (wa_id) WHERE (wa_id IS NOT NULL)'}, {'schemaname': 'public', 'tablename': 'users', 'indexname': 'idx_users_telefone', 'indexdef': 'CREATE INDEX idx_users_telefone ON public.users USING btree (telefone) WHERE (telefone IS NOT NULL)'}, {'schemaname': 'public', 'tablename': 'users', 'indexname': 'idx_users_email', 'indexdef': 'CREATE INDEX idx_users_email ON public.users USING btree (email) WHERE (email IS NOT NULL)'}, {'schemaname': 'public', 'tablename': 'users', 'indexname': 'idx_users_created_at', 'indexdef': 'CREATE INDEX idx_users_created_at ON public.users USING btree (created_at DESC)'}, {'schemaname': 'public', 'tablename': 'appointments', 'indexname': 'idx_appointments_datetime_status', 'indexdef': 'CREATE INDEX idx_appointments_datetime_status ON public.appointments USING btree (date_time, status)'}, {'schemaname': 'public', 'tablename': 'appointments', 'indexname': 'idx_appointments_service_date', 'indexdef': 'CREATE INDEX idx_appointments_service_date ON public.appointments USING btree (service_id, date_time)'}, {'schemaname': 'public', 'tablename': 'meta_logs', 'indexname': 'idx_meta_logs_created_at', 'indexdef': 'CREATE INDEX idx_meta_logs_created_at ON public.meta_logs USING btree (created_at DESC)'}, {'schemaname': 'public', 'tablename': 'admin_users', 'indexname': 'idx_admin_users_username', 'indexdef': 'CREATE INDEX idx_admin_users_username ON public.admin_users USING btree (username)'}, {'schemaname': 'public', 'tablename': 'login_sessions', 'indexname': 'idx_login_sessions_admin_expires', 'indexdef': 'CREATE INDEX idx_login_sessions_admin_expires ON public.login_sessions USING btree (admin_user_id, expires_at)'}]
constraints: [{'constraint_name': 'alembic_version_pkc', 'table_name': 'alembic_version', 'constraint_type': 'PRIMARY KEY', 'column_name': 'version_num', 'foreign_table_name': 'alembic_version', 'foreign_column_name': 'version_num'}, {'constraint_name': 'admins_pkey', 'table_name': 'admins', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'admins', 'foreign_column_name': 'id'}, {'constraint_name': 'admins_email_key', 'table_name': 'admins', 'constraint_type': 'UNIQUE', 'column_name': 'email', 'foreign_table_name': 'admins', 'foreign_column_name': 'email'}, {'constraint_name': 'admins_username_key', 'table_name': 'admins', 'constraint_type': 'UNIQUE', 'column_name': 'username', 'foreign_table_name': 'admins', 'foreign_column_name': 'username'}, {'constraint_name': 'users_pkey', 'table_name': 'users', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'users', 'foreign_column_name': 'id'}, {'constraint_name': 'meta_logs_pkey', 'table_name': 'meta_logs', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'meta_logs', 'foreign_column_name': 'id'}, {'constraint_name': 'appointments_pkey', 'table_name': 'appointments', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'appointments', 'foreign_column_name': 'id'}, {'constraint_name': 'appointments_user_id_fkey', 'table_name': 'appointments', 'constraint_type': 'FOREIGN KEY', 'column_name': 'user_id', 'foreign_table_name': 'users', 'foreign_column_name': 'id'}, {'constraint_name': 'conversations_pkey', 'table_name': 'conversations', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'conversations', 'foreign_column_name': 'id'}, {'constraint_name': 'conversations_user_id_fkey', 'table_name': 'conversations', 'constraint_type': 'FOREIGN KEY', 'column_name': 'user_id', 'foreign_table_name': 'users', 'foreign_column_name': 'id'}, {'constraint_name': 'messages_pkey', 'table_name': 'messages', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'messages', 'foreign_column_name': 'id'}, {'constraint_name': 'messages_conversation_id_fkey', 'table_name': 'messages', 'constraint_type': 'FOREIGN KEY', 'column_name': 'conversation_id', 'foreign_table_name': 'conversations', 'foreign_column_name': 'id'}, {'constraint_name': 'messages_user_id_fkey', 'table_name': 'messages', 'constraint_type': 'FOREIGN KEY', 'column_name': 'user_id', 'foreign_table_name': 'users', 'foreign_column_name': 'id'}, {'constraint_name': 'businesses_pkey', 'table_name': 'businesses', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'blocked_times_pkey', 'table_name': 'blocked_times', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'blocked_times', 'foreign_column_name': 'id'}, {'constraint_name': 'blocked_times_business_id_fkey', 'table_name': 'blocked_times', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'services_pkey', 'table_name': 'services', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'services', 'foreign_column_name': 'id'}, {'constraint_name': 'services_business_id_fkey', 'table_name': 'services', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'appointments_business_id_fkey', 'table_name': 'appointments', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'appointments_service_id_fkey', 'table_name': 'appointments', 'constraint_type': 'FOREIGN KEY', 'column_name': 'service_id', 'foreign_table_name': 'services', 'foreign_column_name': 'id'}, {'constraint_name': 'company_info_pkey', 'table_name': 'company_info', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'company_info', 'foreign_column_name': 'id'}, {'constraint_name': 'company_info_business_id_fkey', 'table_name': 'company_info', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'message_templates_pkey', 'table_name': 'message_templates', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'message_templates', 'foreign_column_name': 'id'}, {'constraint_name': 'message_templates_business_id_fkey', 'table_name': 'message_templates', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'bot_configurations_pkey', 'table_name': 'bot_configurations', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'bot_configurations', 'foreign_column_name': 'id'}, {'constraint_name': 'bot_configurations_business_id_fkey', 'table_name': 'bot_configurations', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'available_slots_pkey', 'table_name': 'available_slots', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'available_slots', 'foreign_column_name': 'id'}, {'constraint_name': 'available_slots_business_id_fkey', 'table_name': 'available_slots', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'available_slots_service_id_fkey', 'table_name': 'available_slots', 'constraint_type': 'FOREIGN KEY', 'column_name': 'service_id', 'foreign_table_name': 'services', 'foreign_column_name': 'id'}, {'constraint_name': 'customer_data_collection_pkey', 'table_name': 'customer_data_collection', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'customer_data_collection', 'foreign_column_name': 'id'}, {'constraint_name': 'customer_data_collection_user_id_fkey', 'table_name': 'customer_data_collection', 'constraint_type': 'FOREIGN KEY', 'column_name': 'user_id', 'foreign_table_name': 'users', 'foreign_column_name': 'id'}, {'constraint_name': 'conversation_contexts_pkey', 'table_name': 'conversation_contexts', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'conversation_contexts', 'foreign_column_name': 'id'}, {'constraint_name': 'conversation_contexts_conversation_id_fkey', 'table_name': 'conversation_contexts', 'constraint_type': 'FOREIGN KEY', 'column_name': 'conversation_id', 'foreign_table_name': 'conversations', 'foreign_column_name': 'id'}, {'constraint_name': 'business_hours_pkey', 'table_name': 'business_hours', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'business_hours', 'foreign_column_name': 'id'}, {'constraint_name': 'business_hours_business_id_fkey', 'table_name': 'business_hours', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'payment_methods_pkey', 'table_name': 'payment_methods', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'payment_methods', 'foreign_column_name': 'id'}, {'constraint_name': 'payment_methods_business_id_fkey', 'table_name': 'payment_methods', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'business_policies_pkey', 'table_name': 'business_policies', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'business_policies', 'foreign_column_name': 'id'}, {'constraint_name': 'business_policies_business_id_fkey', 'table_name': 'business_policies', 'constraint_type': 'FOREIGN KEY', 'column_name': 'business_id', 'foreign_table_name': 'businesses', 'foreign_column_name': 'id'}, {'constraint_name': 'admin_users_pkey', 'table_name': 'admin_users', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'admin_users', 'foreign_column_name': 'id'}, {'constraint_name': 'login_sessions_pkey', 'table_name': 'login_sessions', 'constraint_type': 'PRIMARY KEY', 'column_name': 'id', 'foreign_table_name': 'login_sessions', 'foreign_column_name': 'id'}, {'constraint_name': 'login_sessions_admin_user_id_fkey', 'table_name': 'login_sessions', 'constraint_type': 'FOREIGN KEY', 'column_name': 'admin_user_id', 'foreign_table_name': 'admin_users', 'foreign_column_name': 'id'}]
total_records: 2009</pre></div></div>
                    <div class="test-item test-passed">
                        <div class="test-header">
                            <span class="test-name">✅ Server Startup</span>
                            <span class="test-duration">25.00s</span>
                        </div>
                        <div class="test-details">✅ FastAPI iniciado com sucesso na porta 8000
✅ Dash iniciado com sucesso na porta 8054</div>
            </div>
                    <div class="test-item test-passed">
                        <div class="test-header">
                            <span class="test-name">✅ API Health Check</span>
                            <span class="test-duration">0.00s</span>
                        </div>
                        <div class="test-details">API respondeu com status 200: {'status': 'healthy', 'timestamp': '2025-08-09T20:33:35.463024', 'service': 'WhatsApp Agent API'}</div>
            <div class="metrics"><strong>Métricas:</strong><pre>response_status: 200
response_data: {'status': 'healthy', 'timestamp': '2025-08-09T20:33:35.463024', 'service': 'WhatsApp Agent API'}</pre></div></div>
                    <div class="test-item test-warning">
                        <div class="test-header">
                            <span class="test-name">⚠️ Bot Conversations</span>
                            <span class="test-duration">11.62s</span>
                        </div>
                        <div class="test-details">
            📊 Resultados dos testes de conversação:
            - 10/14 mensagens processadas com sucesso
            - Taxa de sucesso: 71.4%
            
            Detalhes:
            ✅ oi... - Status: 200
✅ olá... - Status: 200
✅ bom dia... - Status: 200
✅ quero agendar... - Status: 200
✅ horário disponível... - Status: 200
✅ cancelar agendamento... - Status: 200
✅ não quero mais... - Status: 200
✅ mudar horário... - Status: 200
✅ preços... - Status: 200
✅ serviços... - Status: 200
❌ endereço... - Status: 429
❌ gostaria de cortar cabelo amanhã às 14h... - Status: 429
❌ spamspamspamspamspamspamspamspamspamspamspamspamsp... - Status: 429
❌ <script>alert('xss')</script>... - Status: 429</div>
            <div class="metrics"><strong>Métricas:</strong><pre>total_messages: 14
successful_messages: 10
success_rate: 71.42857142857143</pre></div></div>
                    <div class="test-item test-passed">
                        <div class="test-header">
                            <span class="test-name">✅ Rate Limiting</span>
                            <span class="test-duration">31.18s</span>
                        </div>
                        <div class="test-details">Rate limiting funcionando perfeitamente: 43/133 requisições bloqueadas (90 bem-sucedidas)</div>
            <div class="metrics"><strong>Métricas:</strong><pre>rate_limited_requests: 43
successful_requests: 90
total_requests: 133</pre></div></div>
                    <div class="test-item test-passed">
                        <div class="test-header">
                            <span class="test-name">✅ Dashboard Health</span>
                            <span class="test-duration">0.01s</span>
                        </div>
                        <div class="test-details">Dashboard respondeu corretamente. Indicadores encontrados: ['dash', '_dash-config', 'plotly']</div>
            <div class="metrics"><strong>Métricas:</strong><pre>response_status: 200
content_length: 41926</pre></div></div>
                    <div class="test-item test-passed">
                        <div class="test-header">
                            <span class="test-name">✅ Security Vulnerabilities</span>
                            <span class="test-duration">247.98s</span>
                        </div>
                        <div class="test-details">
            🛡️ Testes de segurança:
            - Score de segurança: 100.0%
            - 0 possíveis vulnerabilidades encontradas
            
            Detalhes:
            ✅ SQL Injection bloqueado (erro de conexão): '; DROP TABLE users; --...
✅ SQL Injection bloqueado (erro de conexão): 1' OR '1'='1...
✅ SQL Injection bloqueado (erro de conexão): admin'--...
✅ SQL Injection bloqueado (erro de conexão): 1' UNION SELECT NULL--...
✅ XSS payload bloqueado: <script>alert('xss')</script>...
✅ XSS payload bloqueado: javascript:alert('xss')...
✅ XSS payload bloqueado: <img src=x onerror=alert('xss'...
✅ XSS payload bloqueado: ';alert(String.fromCharCode(88...</div>
            <div class="metrics"><strong>Métricas:</strong><pre>security_score: 100.0
vulnerable_tests: 0
total_tests: 8</pre></div></div>
                    <div class="test-item test-passed">
                        <div class="test-header">
                            <span class="test-name">✅ Database Integration</span>
                            <span class="test-duration">0.02s</span>
                        </div>
                        <div class="test-details">
                    🗄️ Testes de integração com banco:
                    - 5/5 operações bem-sucedidas
                    - Taxa de sucesso: 100.0%
                    
                    Detalhes:
                    ✅ INSERT funcionando
✅ SELECT funcionando
✅ UPDATE funcionando
✅ DELETE funcionando
✅ Integridade referencial funcionando</div>
            <div class="metrics"><strong>Métricas:</strong><pre>successful_operations: 5
total_operations: 5
success_rate: 100.0</pre></div></div>
                    <div class="test-item test-failed">
                        <div class="test-header">
                            <span class="test-name">❌ Performance Load Test</span>
                            <span class="test-duration">31.98s</span>
                        </div>
                        <div class="test-details">
                ⚡ Teste de performance (30s):
                - 10 usuários simultâneos
                - 0 requisições totais
                - 0.0 req/s
                - 100.0% taxa de erro
                - CPU: 2.1%
                - Memória: 32.9%
                </div>
            <div class="metrics"><strong>Métricas:</strong><pre>concurrent_users: 10
total_requests: 0
requests_per_second: 0.0
error_rate: 100.0
cpu_usage: 2.1
memory_usage: 32.9</pre></div></div>
                </div>
                
                <div class="footer">
                    <p>Relatório gerado automaticamente pelo WhatsApp Agent Test Suite</p>
                    <p>GitHub Copilot - 09/08/2025 20:39:05</p>
                </div>
            </div>
        </body>
        </html>
        